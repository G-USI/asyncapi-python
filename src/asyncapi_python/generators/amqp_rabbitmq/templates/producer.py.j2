from .messages import *
from .base import BaseProducer


class Producer(BaseProducer):
    {%- for channel in exchange_channels %}
    async def {{ channel.field_name }}(self, message: {{channel.schema}}) -> None:
        return await self._exchange_send("{{ channel.channel_name }}", message)
    {% endfor %}
    {%- for channel in queue_channels %}
    async def {{ channel.field_name }}(self, message: {{channel.schema}}) -> None:
        return await self._queue_send("{{ channel.channel_name }}", message)
    {% endfor %}
    def _exchanges(self):
        return [
            {%- for channel in exchange_channels%}
            "{{channel.channel_name}}",
            {%- endfor %}
        ]

    def _queues(self):
        return [
            {%- for channel in queue_channels%}
            "{{channel.channel_name}}",
            {%- endfor %}
        ]
